<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="心宿, 米粒工作室, 昊天兽王, 心率广播网站, 心率监测, 蓝牙心率, 心电图, QRS脉冲">
    <meta name="description" content="心宿心率广播网站 - 实时蓝牙心率监测与视觉化反馈，米粒工作室 & 昊天兽王 出品。">
    <meta name="author" content="米粒工作室 & 昊天兽王">
    <title>心宿 · 心率检测</title>
    <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="style1 light-mode">
    <!-- 3D背景容器 -->
    <div id="canvas-container"></div>
    
    <!-- 警报覆盖层 -->
    <div class="alarm-overlay" id="alarmOverlay"></div>

    <!-- 顶部控制栏 -->
    <header class="top-bar">
        <div class="brand">
            <div class="logo">心宿</div>
            <div class="status-indicator">
                <span class="status-dot" id="statusDot"></span>
                <span id="statusText">未连接</span>
            </div>
        </div>
        
        <div class="controls">
            <div class="sound-control">
                <span class="sound-label">音效</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="audioToggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <button class="connect-btn" id="connectBtn">连接设备</button>
            <button class="connect-btn style-toggle-btn" onclick="toggleStyle()">换个样式</button>
            <button class="connect-btn" id="settingsBtn">设置</button>
        </div>
    </header>

    <!-- 主内容 -->
    <main class="main-content">
        <!-- 心率显示 -->
        <section class="heart-rate-section">
            <div class="heart-rate-display">
                <span id="bpm-display">--</span><span id="bpm-unit">次/分</span>
            </div>
        </section>

        <!-- ECG 显示 -->
        <section class="ecg-section">
            <div class="ecg-wrapper">
                <div class="ecg-grid"></div>
                <canvas id="ecg-canvas"></canvas>
            </div>
        </section>
    </main>

    <!-- 底部详细信息 -->
    <footer class="footer">
        <div class="footer-content">
            <div class="warning-info">
                警告：心电图像是心率模拟结果，仅供娱乐，切勿代替医疗器械
            </div>
            <div class="footer-info">
                <a href="https://昊天兽王.top" target="_blank">昊天兽王</a> | 
                <a href="https://milir.top/" target="_blank">milirstudio</a> | 
                <a href="https://github.com/haotianshouwang/xinsu" target="_blank">心宿 GitHub</a> | 
                <a href="https://beian.miit.gov.cn/" target="_blank">备-xxxxxxxxxxxx</a>
            </div>
        </div>
    </footer>

    <!-- 设置面板 -->
    <div id="settings-panel" class="settings-panel">
        <div class="settings-header">
            <h3>设置</h3>
            <button id="closeSettingsBtn">×</button>
        </div>
        <div class="settings-container">
            <!-- 设置导航 -->
            <div class="settings-nav">
                <button class="settings-nav-item active" data-section="interface">界面设置</button>
                <button class="settings-nav-item" data-section="background">背景设置</button>
                <button class="settings-nav-item" data-section="logs">日志设置</button>
            </div>
            <!-- 设置内容 -->
            <div class="settings-content">
                <!-- 界面设置 -->
                <div class="settings-section" id="interface-section">
                    <h4>界面设置</h4>
                    <div class="settings-group">
                        <label class="settings-label">界面样式</label>
                        <div class="interface-options">
                            <div class="interface-option" data-style="style1">
                                <div class="interface-preview style1-preview"></div>
                                <span>样式 1</span>
                            </div>
                            <div class="interface-option" data-style="style2">
                                <div class="interface-preview style2-preview"></div>
                                <span>样式 2</span>
                            </div>
                        </div>
                    </div>
                    <div class="settings-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">夜间模式</span>
                        </label>
                    </div>
                </div>

                <!-- 背景设置 -->
                <div class="settings-section" id="background-section" style="display: none;">
                    <h4>背景设置</h4>
                    <div class="settings-group">
                        <label class="settings-label">背景类型</label>
                        <select id="bgTypeSelect">
                            <option value="color">纯色背景</option>
                            <option value="image">图片背景</option>
                        </select>
                    </div>
                    <div class="settings-group bg-color-group">
                        <label class="settings-label">背景颜色</label>
                        <input type="color" id="bgColorPicker" value="#000000">
                    </div>
                    <div class="settings-group bg-image-group">
                        <label class="settings-label">背景图片</label>
                        <input type="text" id="bgImageUrl" placeholder="输入图片URL">
                        <div class="bg-image-local">
                            <label class="settings-label">本地图片</label>
                            <select id="bgLocalImageSelect">
                                <option value="">选择本地图片</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 日志设置 -->
                <div class="settings-section" id="logs-section" style="display: none;">
                    <h4>日志设置</h4>
                    <div class="settings-group">
                        <label class="settings-label">日志级别</label>
                        <select id="logLevelSelect">
                            <option value="none">关闭</option>
                            <option value="basic" selected>基本</option>
                            <option value="detailed">详细</option>
                        </select>
                    </div>
                    <div class="settings-group">
                        <label class="module-log-item">
                            <input type="checkbox" id="logDisplay">
                            <span>显示日志面板</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 日志显示面板 -->
    <div id="log-panel" class="log-panel">
        <div class="log-header">
            <h4>日志</h4>
            <div class="log-controls">
                <button id="clearLogBtn">清空</button>
                <button id="pinLogBtn">📌</button>
                <button id="closeLogBtn">×</button>
            </div>
        </div>
        <div class="log-content" id="logContent"></div>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>